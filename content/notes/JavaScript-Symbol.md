+++
title = 'JavaScript Symbol'
date = 2025-05-20T18:57:04+08:00
draft = false
categories = ["Notes"]
tags = ["Notes", "Input"]
+++

> ä¸€äº›ç²—ç•¥åœ°è§è§£ï¼Œå¦‚æœ‰å†™é”™æˆ–ä½çº§é”™è¯¯ï¼Œæ¬¢è¿æ‚¨çš„æŒ‡æ­£

æ ¹æ®è§„èŒƒï¼Œåªæœ‰[ä¸¤ç§åŸå§‹ç±»å‹](https://developer.mozilla.org/zh-CN/docs/Glossary/Primitive)å¯ä»¥ç”¨ä½œå¯¹è±¡å±æ€§é”®:

- å­—ç¬¦ä¸²ç±»å‹
- Symbol ç±»å‹

å¦‚æœä¸ç”¨è¿™ä¸¤ç§åŸå§‹ç±»å‹ä½œä¸ºå¯¹è±¡çš„å±æ€§é”®ï¼Œä¾‹å¦‚[[æ•°æ®ç±»å‹ - info#Number ç±»å‹|æ•°å­—]]ï¼Œå®ƒä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚æ‰€ä»¥ Â `obj[1]`Â  ä¸ Â `obj["1"]`Â  ç›¸åŒï¼Œè€Œ Â `obj[true]`Â  ä¸ Â `obj["true"]`Â  ç›¸åŒã€‚

### Symbol

"symbol" å€¼è¡¨ç¤ºå”¯ä¸€çš„æ ‡è¯†ç¬¦
å¯ä»¥ä½¿ç”¨ `Symbol()` æ¥åˆ›å»ºè¿™ç§ç±»å‹çš„å€¼ï¼š

```js
let id = Symbol();
```

åœ¨æˆ‘ä»¬åˆ›å»ºæ—¶ï¼Œä¹Ÿå¯ä»¥ç»™ symbol ä¸€ä¸ªæè¿° (ä¹Ÿç§°ä¸º symbol å)

```js
// å˜é‡Â idÂ æ˜¯ä¸€ä¸ªÂ SymbolÂ ç±»å‹çš„å˜é‡ï¼Œå…¶æè¿°ä¸ºÂ "id"ã€‚
let id = Symbol("id");
```

Symbol ä¿è¯æ˜¯å”¯ä¸€çš„ã€‚å³ä½¿æˆ‘ä»¬åˆ›å»ºäº†è®¸å¤šç›¸åŒæè¿°çš„ symbolï¼Œå®ƒä»¬çš„å€¼ä¸ä½¿ä¸åŒçš„ã€‚æè¿°ä»…ä»…åªæ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼Œä¸ä¼šå½±å“ä»»ä½•ä¸œè¥¿

```js
let id1 = Symbol("id");
let id2 = Symbol("id");
console.log(id1 === id2); // false
```

#### Symbol å±æ€§ä¸å­—ç¬¦ä¸²å±æ€§çš„åŒºåˆ«

- å­—ç¬¦ä¸²é”®ä¼šè¦†ç›–åŒåå±æ€§:

```js
let user = { id: 1 };
user.id = 2; // è¦†ç›–åŸå€¼
console.log(user.id); // 2
```

- Symbol é”®ä¸ä¼šè¦†ç›–åŒåå±æ€§ (å› ä¸ºå®ƒè¡¨ç¤ºå”¯ä¸€çš„æ ‡è¯†ç¬¦)

```js
let user = { id: 1 };
let idSymbol = Symbol("id");
user[idSymbol] = 2; // æ·»åŠ æ–°å±æ€§ï¼Œä¸å½±å“å­—ç¬¦ä¸²é”®id
console.log(user.id); // 1
console.log(user[idSymbol]); // 2
```

**Symbol ç±»å‹çš„å±æ€§é”®ä¸èƒ½ç”¨ç‚¹è¯­æ³•è®¿é—®ï¼Œåªèƒ½é€šè¿‡æ–¹æ‹¬å·è¯­æ³• `obj[symbolKey]` æ¥è®¿é—®å¯¹åº”çš„ Symbol å±æ€§ã€‚**

ä¾‹å¦‚ï¼Œ`user.id` ä¼šè®¿é—®å­—ç¬¦ä¸²é”®"id"ï¼Œè€Œä¸æ˜¯ Symbol é”® idã€‚å› æ­¤ï¼Œè®¿é—® Symbol å±æ€§å¿…é¡»ä½¿ç”¨æ–¹æ‹¬å·å’Œå¯¹åº”çš„ Symbol å˜é‡ï¼Œå¦‚ `user[id]`ã€‚

> [!NOTE] symbol ä¸ä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²
> JavaScript ä¸­çš„å¤§å¤šæ•°å€¼éƒ½æ”¯æŒå­—ç¬¦ä¸²çš„éšå¼è½¬æ¢ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ Â `alert`Â  ä»»ä½•å€¼ï¼Œéƒ½å¯ä»¥ç”Ÿæ•ˆã€‚Symbol æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒä¸ä¼šè¢«è‡ªåŠ¨è½¬æ¢ã€‚
> ä¾‹å¦‚ï¼Œè¿™ä¸ª `alert` å°†ä¼šæç¤ºå‡ºé”™
>
> ```js
> Let id = Symbol ("id");
> Alert (id); // ç±»å‹é”™è¯¯ï¼šæ— æ³•å°† symbol å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚
> ```
>
> å¦‚æœçœŸçš„å¾ˆæƒ³æ˜¾ç¤ºä¸€ä¸ª symbolï¼Œæˆ‘ä»¬éœ€è¦åœ¨å®ƒä¸Šé¢è°ƒç”¨ `.toString()` æˆ–è€…è·å– `symbol.Description` å±æ€§ï¼Œåªæ˜¾ç¤ºæè¿° (description)
>
> ```js
> Let id = Symbol ("id");
> Alert (id.ToString ()); // Symbol (id)ï¼Œç°åœ¨å®ƒæœ‰æ•ˆäº†
> Alert (id. Description); // id
> ```

### "éšè—"å±æ€§

Symbol å…è®¸æˆ‘ä»¬åˆ›å»ºå¯¹è±¡çš„ â€œéšè—â€å±æ€§ï¼Œä»£ç çš„ä»»ä½•å…¶ä»–éƒ¨åˆ†éƒ½ä¸èƒ½æ„å¤–æˆ–é‡å†™è¿™äº›å±æ€§

ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯å±äºç¬¬ä¸‰æ–¹ä»£ç çš„ Â `user`Â  å¯¹è±¡ï¼Œæˆ‘ä»¬æƒ³è¦ç»™å®ƒä»¬æ·»åŠ ä¸€äº›æ ‡è¯†ç¬¦ã€‚

æˆ‘ä»¬å¯ä»¥ç»™å®ƒä»¬ä½¿ç”¨ symbol é”®ï¼š

```js
let user = {
  // å±äºå¦ä¸€ä¸ªä»£ç 
  name: "John",
};

let id = Symbol("id");

user[id] = 1;

alert(user[id]); // æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ symbol ä½œä¸ºé”®æ¥è®¿é—®æ•°æ®
```

ç”±äº Â `user`Â  å¯¹è±¡å±äºå¦ä¸€ä¸ªä»£ç åº“ï¼Œæ‰€ä»¥å‘å®ƒä»¬æ·»åŠ å­—æ®µæ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºæˆ‘ä»¬å¯èƒ½ä¼šå½±å“ä»£ç åº“ä¸­çš„å…¶ä»–é¢„å®šä¹‰è¡Œä¸ºã€‚ä½† symbol å±æ€§ä¸ä¼šè¢«æ„å¤–è®¿é—®åˆ°ã€‚ç¬¬ä¸‰æ–¹ä»£ç ä¸ä¼šçŸ¥é“æ–°å®šä¹‰çš„ symbolï¼Œå› æ­¤å°† symbol æ·»åŠ åˆ° Â `user`Â  å¯¹è±¡æ˜¯å®‰å…¨çš„ã€‚

### å¯¹è±¡å­—é¢é‡ä¸­çš„ symbol

å¦‚æœæˆ‘ä»¬è¦åœ¨å¯¹è±¡å­—é¢é‡ Â `{...}`Â  ä¸­ä½¿ç”¨ symbolï¼Œåˆ™éœ€è¦ä½¿ç”¨æ–¹æ‹¬å·æŠŠå®ƒæ‹¬èµ·æ¥ã€‚

å°±åƒè¿™æ ·ï¼š

```js
let id = Symbol("id");

let user = {
  name: "John",
  [id]: 123, // è€Œä¸æ˜¯ "id"ï¼š123
};
è¿™æ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦;
```

### Symbol åœ¨ for... In ä¸­ä¼šè¢«è·³è¿‡

symbol å±æ€§ä¸å‚ä¸ Â `for..in`Â  å¾ªç¯ã€‚
ä¾‹å¦‚

```js
let id = Symbol("id");
let user = {
  name: "John",
  age: 30,
  [id]: 123,
};

for (let key in user) alert(key); // name, ageï¼ˆæ²¡æœ‰ symbolï¼‰

// ä½¿ç”¨ symbol ä»»åŠ¡ç›´æ¥è®¿é—®
alert("Direct: " + user[id]); // Direct: 123
```

[Object.keys(user)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys)Â  ä¹Ÿä¼šå¿½ç•¥å®ƒä»¬ã€‚è¿™æ˜¯ä¸€èˆ¬â€œéšè—ç¬¦å·å±æ€§â€åŸåˆ™çš„ä¸€éƒ¨åˆ†ã€‚å¦‚æœå¦ä¸€ä¸ªè„šæœ¬æˆ–åº“éå†æˆ‘ä»¬çš„å¯¹è±¡ï¼Œå®ƒä¸ä¼šæ„å¤–åœ°è®¿é—®åˆ°ç¬¦å·å±æ€§ã€‚

ç›¸åï¼Œ[Object.assign](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)Â  ä¼šåŒæ—¶å¤åˆ¶å­—ç¬¦ä¸²å’Œ symbol å±æ€§ï¼š

```js
let id = Symbol("id");
let user = {
  [id]: 123,
};

let clone = Object.assign({}, user);

alert(clone[id]); // 123
```

### å…¨å±€ symbol

é€šå¸¸æ‰€æœ‰çš„ symbol éƒ½æ˜¯ä¸åŒçš„ï¼Œå³ä½¿å®ƒä»¬æœ‰ç›¸åŒçš„åå­—ã€‚ä½†æœ‰æ—¶æˆ‘ä»¬æƒ³è¦åå­—ç›¸åŒçš„ symbol å…·æœ‰ç›¸åŒçš„å®ä¾‹ã€‚ä¾‹å¦‚ï¼Œåº”ç”¨ç¨‹åºçš„ä¸åŒéƒ¨åˆ†æƒ³è¦è®¿é—®çš„ symbolÂ `"id"`Â  æŒ‡çš„æ˜¯å®Œå…¨ç›¸åŒçš„å±æ€§ã€‚

è¿™é‡Œæœ‰ä¸€ä¸ª **å…¨å±€ symbol æ³¨å†Œè¡¨**ã€‚æˆ‘ä»¬å¯ä»¥åœ¨å…¶ä¸­åˆ›å»º symbol å¹¶åœ¨ç¨åè®¿é—®å®ƒä»¬ï¼Œå®ƒå¯ä»¥ç¡®ä¿æ¯æ¬¡è®¿é—®ç›¸åŒåå­— symbol æ—¶ï¼Œè¿”å›çš„éƒ½æ˜¯ç›¸åŒçš„ symbolã€‚

#### Symbol. For (key)

è¦ä»æ³¨å†Œè¡¨ä¸­è¯»å–ï¼ˆä¸å­˜åœ¨åˆ™åˆ›å»ºï¼‰symbolï¼Œè¦ä½¿ç”¨ Â **`Symbol.for(key)`**ã€‚

åœ¨ JavaScript å¼•æ“ç»´æŠ¤çš„ **å…¨å±€ symbol æ³¨å†Œè¡¨**ä¸­ï¼Œå¦‚æœæœ‰ä¸€ä¸ªæè¿°ä¸º Â `key`Â  çš„ symbolï¼Œåˆ™è¿”å›è¯¥ symbolï¼Œå¦åˆ™å°†åˆ›å»ºä¸€ä¸ªæ–° symbolï¼ˆ`Symbol(key)`ï¼‰ï¼Œå¹¶é€šè¿‡ç»™å®šçš„ Â `key`Â  å°†å…¶å­˜å‚¨åœ¨æ³¨å†Œè¡¨ä¸­ã€‚

```js
// åˆ›å»ºæˆ–è·å–å…¨å±€æ³¨å†Œçš„ Symbol
let sym1 = Symbol.for("id"); // æ³¨å†Œè¡¨ä¸­æ²¡æœ‰ "id"ï¼Œåˆ›å»ºæ–° Symbol
let sym2 = Symbol.for("id"); // æ‰¾åˆ°å·²æ³¨å†Œçš„ "id"ï¼Œè¿”å›åŒä¸€ Symbol
console.log(sym1 === sym2); // true
```

æ³¨å†Œè¡¨å†…çš„ symbol è¢«ç§°ä¸º Â **å…¨å±€ symbol**ã€‚

#### Symbol. KeyFor

æŒ‰åå­—è¿”å›ä¸€ä¸ª symbolã€‚ç›¸åï¼Œé€šè¿‡å…¨å±€ symbol è¿”å›ä¸€ä¸ªåå­—ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Â `Symbol.keyFor(sym)`ï¼š

```js
// é€šè¿‡ name è·å– symbol
let sym = Symbol.for("name");
let sym2 = Symbol.for("id");

// é€šè¿‡ symbol è·å– name
alert(Symbol.keyFor(sym)); // name
alert(Symbol.keyFor(sym2)); // id
```

`Symbol.keyFor`Â  å†…éƒ¨ä½¿ç”¨å…¨å±€ symbol æ³¨å†Œè¡¨æ¥æŸ¥æ‰¾ symbol çš„é”®ã€‚æ‰€ä»¥å®ƒä¸é€‚ç”¨äºéå…¨å±€ symbolã€‚å¦‚æœ symbol ä¸æ˜¯å…¨å±€çš„ï¼Œå®ƒå°†æ— æ³•æ‰¾åˆ°å®ƒå¹¶è¿”å› Â `undefined`ã€‚

## ğŸ“– å‚è€ƒæ–‡çŒ®

1. https://zh.javascript.info/symbol
